<?xml version="1.0" encoding="utf-8"?>
<mdscript name="ChillHeadHunter" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
    <cues>
        <cue name="LoadStuffAndSetup">
			<conditions>
				<event_universe_generated/>
			</conditions>
			<actions>
                <debug_text text="'HeadHunter setup check...'" filter="scripts" />
				<do_if value="not global.$HeadHunterWantedTracker?">
					<set_value name="global.$HeadHunterWantedTracker" exact="table[]" />
                    <set_value name="global.$HeadHunterNPCNotify" exact="true" />
                    <set_value name="global.$HeadHunterProximityNotify" exact="true" />
                    <set_value name="global.$HeadHunterBountyMultiplier" exact="1.0" />
                    <debug_text text="'HeadHunter: initial variables set. WantedTracker: %s \nNPCNotify: %s \nMultiplier: %s \nBounty tracker not found so initialized to empty table.'.[global.$HeadHunterWantedTracker,global.$HeadHunterNPCNotify,global.$HeadHunterBountyMultiplier]" filter="scripts" />
				</do_if>
                <do_else>
                    <debug_text text="'HeadHunter Wanted Board was ready.'" filter="scripts" />
                </do_else>
                <show_help color="[179,102,255,255]" duration="12s" halign="'center'" position="1" custom="'Head Hunter Mod Installed: This is the way'" />
			</actions>
		</cue>
        <cue name="HHOptsInit" instantiate="false">
            <actions>
                <debug_text text="'HeadHunter Options: Go, Init! Go on, git!'" />
            </actions>
            <cues>
                <cue name="RegisterHHOpts" instantiate="true">
                    <conditions>
                        <event_cue_signalled cue="md.Simple_Menu_API.Reloaded" />
                    </conditions>
                    <actions>
                        <signal_cue_instantly
                            cue="md.Simple_Menu_API.Register_Options_Menu"
                            param="table[
                    $id = 'HeadHunterOptions',
                    $columns = 3, 
                    $title = 'HeadHunter Settings',
                    $onOpen = HHOptsMenu
                    ]" />
                    </actions>
                </cue>
                <cue name="HHOptsMenu" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                            param="table[
								$col = 1,
								$colSpan = 2,
								$text = 'NPC Wanted Claim Notifications',
								$mouseOverText= 'Receive notifications for NPCs claiming Wanted bounties.',
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button"
                            param="table[
								$col = 3, 
								$colSpan = 1,
								$text = table[
								  $text   =  if global.$HeadHunterNPCNotify == true then 'Enabled' else 'Disabled', 
								  $color  =  if global.$HeadHunterNPCNotify == true then 'Helper.color.green' else 'Helper.color.red',
								  $halign = 'center',
								],
								$onClick = HHNotifyToggle,
								$onRightClick = HHNotifyToggle,
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                            param="table[
								$col = 1,
								$colSpan = 2,
								$text = 'AI Ship Proximity Notifications',
								$mouseOverText= 'Enables notifications when player AI ships spot a wanted ship.',
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button"
                            param="table[
								$col = 3, 
								$colSpan = 1,
								$text = table[
								  $text   =  if global.$HeadHunterProximityNotify == true then 'Enabled' else 'Disabled', 
								  $color  =  if global.$HeadHunterProximityNotify == true then 'Helper.color.green' else 'Helper.color.red',
								  $halign = 'center',
								],
								$onClick = ProximityNotifyToggle,
								$onRightClick = ProximityNotifyToggle,
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                            param="table[
								$col = 1,
								$colSpan = 1,
								$text = 'General Bounty Multiplier',
								$mouseOverText= 'Affects non-Wanted bounties only. 1.0x is mod default',
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Slider" 
                            param="table[
                                $col = 2,
                                $colSpan=2,
                                $start = if global.$HeadHunterBountyMultiplier != null then global.$HeadHunterBountyMultiplier else 1.0 ,
                                $suffix = 'x',
                                $min = 0.0,
                                $max = 3.0,
                                $step = 0.1,
                                $onSliderCellConfirm = HHBountyMultiplierConfirm,
                            ]" />
                            <!-- Debug -->
                            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                                param="table[
                                    $col = 1,
                                    $colSpan = 2,
                                    $text = 'Debug Stuff',
                                ]" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                                param="table[
                                    $col = 1,
                                    $colSpan = 2,
                                    $text = 'Reset Wanted Board',
                                    $mouseOverText= 'Cannot be undone!',
                                ]" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button"
                                param="table[
                                    $col = 3, 
                                    $colSpan = 1,
                                    $text = table[
                                    $text   =  'RESET', 
                                    $color  =  'Helper.color.red',
                                    $halign = 'center',
                                    ],
                                    $onClick = ClearWantedBoard,
                                    $onRightClick = ClearWantedBoard,
                                ]" />
                            <!-- for debug menu -->
                            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                                param="table[
                                    $col = 1,
                                    $colSpan = 2,
                                    $text = 'Print Wanted Board',
                                    $mouseOverText= '',
                                ]" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button"
                                param="table[
                                    $col = 3, 
                                    $colSpan = 1,
                                    $text = table[
                                    $text   =  'Print to log', 
                                    $color  =  'Helper.color.white',
                                    $halign = 'center',
                                    ],
                                    $onClick = PrintWantedBoard,
                                    $onRightClick = PrintWantedBoard,
                                ]" />
                    </actions>
                </cue>
                <cue name="HHBountyMultiplierConfirm" instantiate="true">
                    <conditions><event_cue_signalled /></conditions>
                    <actions>
                        <set_value name="global.$HeadHunterBountyMultiplier" exact="event.param.$value" />
                    </actions>
                </cue>
                <cue name="HHNotifyToggle" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="global.$HeadHunterNPCNotify"
                            exact="if global.$HeadHunterNPCNotify == true then false else true" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu" />
                    </actions>
                </cue>
                <cue name="ProximityNotifyToggle" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="global.$HeadHunterProximityNotify"
                            exact="if global.$HeadHunterProximityNotify == true then false else true" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu" />
                    </actions>
                </cue>
                <cue name="ClearWantedBoard" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <clear_table table="global.$HeadHunterWantedTracker" />
                        <clear_group group="global.$HHAllShips" />
                        <clear_group group="global.$HHAllWanted" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu" />
                    </actions>
                </cue>
                <cue name="PrintWantedBoard" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <do_for_each name="$bleh" in="global.$HeadHunterWantedTracker" >
                            <debug_to_file name="'wanted'" directory="'HeadHunter'"
                            text="'(HeadHunter Table) Killer: %s %s || Running Total: %s || Last Spotted: %s || Last Victim: %s'.[global.$HeadHunterWantedTracker.{$bleh}.$killer.idcode,global.$HeadHunterWantedTracker.{$bleh}.$killer.knownname,global.$HeadHunterWantedTracker.{$bleh}.$value.formatted.default,global.$HeadHunterWantedTracker.{$bleh}.$lastseen.knownname,global.$HeadHunterWantedTracker.{$bleh}.$lastvictimfaction.knownname]"
                            output="false" append="true" chance="100" /> 
                        </do_for_each>
                        <do_for_each name="$bleh" in="global.$HHAllWanted" >
                            <debug_to_file name="'wanted'" directory="'HeadHunter'"
                            text="'(HHAllWanted) Killer: %s %s'.[$bleh.idcode,$bleh.knownname]"
                            output="false" append="true" chance="100" />
                        </do_for_each>
                        <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu" />
                    </actions>
                </cue>
            </cues>
        </cue>
    </cues>
</mdscript>