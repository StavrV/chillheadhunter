<?xml version="1.0" encoding="utf-8"?>
<mdscript name="ChillHeadHunter" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="md.xsd">
    <cues>
        <cue name="FirstTimeSetup">
			<conditions>
				<check_any>
					<event_universe_generated/>
					<event_cue_signalled cue="md.Setup.Start"/>
				</check_any>
			</conditions>
			<actions>
                <debug_text text="'HeadHunter setup check...'" filter="scripts" />
				<do_if value="not global.$HeadHunterWantedTracker?">
					<set_value name="global.$HeadHunterWantedTracker" exact="table[]" /> <!-- TODO: needs to be a table -->
                    <set_value name="global.$HeadHunterNotify" exact="true" />
                    <set_value name="global.$HeadHunterBountyMultiplier" exact="1.0" />
                    <debug_text text="'HeadHunter: initial variables set. WantedTracker: %s \nNotify: %s \nMultiplier: %s \nBounty tracker not found so initialized to empty table.'.[global.$HeadHunterWantedTracker,global.$HeadHunterNotify,global.$HeadHunterBountyMultiplier]" filter="scripts" />
				</do_if>
                <do_else>
                    <debug_text text="'HeadHunter: initial variables were set so carrying on. WantedTracker: %s\nNotify: %s\nMultiplier: %s'.[global.$HeadHunterWantedTracker,global.$HeadHunterNotify,global.$HeadHunterBountyMultiplier]" filter="scripts"/>
                </do_else>
			</actions>
		</cue>
        <cue name="HHOptsInit" instantiate="false">
            <actions>
                <debug_text text="'HeadHunter Options: Go, Init! Go on, git!'" />
            </actions>
            <cues>
                <cue name="RegisterHHOpts" instantiate="true">
                    <conditions>
                        <event_cue_signalled cue="md.Simple_Menu_API.Reloaded" />
                    </conditions>
                    <actions>
                        <signal_cue_instantly
                            cue="md.Simple_Menu_API.Register_Options_Menu"
                            param="table[
                    $id = 'HeadHunterOptions',
                    $columns = 3, 
                    $title = 'HeadHunter Options',
                    $onOpen = HHOptsMenu
                    ]" />
                    </actions>
                </cue>
                <cue name="HHOptsMenu" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                            param="table[
								$col = 1,
								$colSpan = 2,
								$text = 'Bounty Claim Notifications',
								$mouseOverText= 'Notification popups when a bounty is claimed in the galaxy',
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button"
                            param="table[
								$col = 3, 
								$colSpan = 1,
								$text = table[
								  $text   =  if global.$HeadHunterNotify == true then 'Enabled' else 'Disabled', 
								  $color  =  if global.$HeadHunterNotify == true then 'Helper.color.green' else 'Helper.color.red',
								  $halign = 'center',
								],
								$onClick = HHNotifyToggle,
								$onRightClick = HHNotifyToggle,
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                            param="table[
								$col = 1,
								$colSpan = 1,
								$text = 'Bounty Multiplier',
								$mouseOverText= '1.0x is mod default',
							]" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Make_Slider" 
                            param="table[
                                $col = 2,
                                $colSpan=2,
                                $start = if global.$HeadHunterBountyMultiplier != null then global.$HeadHunterBountyMultiplier else 1.0 ,
                                $suffix = 'x',
                                $min = 0.0,
                                $max = 3.0,
                                $step = 0.1,
                                $onSliderCellConfirm = HHBountyMultiplierConfirm,
                            ]" />
                            <!-- TODO: Temp for debug -->
                            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
                                param="table[
                                    $col = 1,
                                    $colSpan = 2,
                                    $text = 'Clear Wanted Board',
                                    $mouseOverText= 'BLEH!',
                                ]" />
                            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Button"
                                param="table[
                                    $col = 3, 
                                    $colSpan = 1,
                                    $text = table[
                                    $text   =  'Do eeet!', 
                                    $color  =  'Helper.color.red',
                                    $halign = 'center',
                                    ],
                                    $onClick = ClearWantedBoard,
                                    $onRightClick = ClearWantedBoard,
                                ]" />
                    </actions>
                </cue>
                <cue name="HHBountyMultiplierConfirm" instantiate="true">
                    <conditions><event_cue_signalled /></conditions>
                    <actions>
                        <set_value name="global.$HeadHunterBountyMultiplier" exact="event.param.$value" />
                    </actions>
                </cue>
                <cue name="HHNotifyToggle" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <set_value name="global.$HeadHunterNotify"
                            exact="if global.$HeadHunterNotify == true then false else true" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu" />
                    </actions>
                </cue>
                <cue name="ClearWantedBoard" instantiate="true">
                    <conditions>
                        <event_cue_signalled />
                    </conditions>
                    <actions>
                        <clear_table table="global.$HeadHunterWantedTracker" />
                        <signal_cue_instantly cue="md.Simple_Menu_API.Refresh_Menu" />
                    </actions>
                </cue>
            </cues>
        </cue>
    </cues>
</mdscript>